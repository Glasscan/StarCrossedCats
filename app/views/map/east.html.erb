<title>Welcome to our wonderful domain!</title>
<meta name="description" content="A desciption of our website and introduction.">
<%= stylesheet_link_tag('application') %>
<%= render(:partial => "default")%>

<p>You require Chrome or IE9 to view this page properly.</p>
<p>This page is a (possible) view of what can be seen in the Eastern Hemisphere</p>
<div id="timer">
  <span>00:00:00</span>
</div>

<svg id='test' width="1000" height="800" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <defs>
   <filter id="f1" x="0" y=0>
     <feGaussianBlur in="SourceGraphic" stdDeviation="1"/>
   </filter>
  </defs>
<!--
<%x_scale = -5%>
<%x_shift = 500%>

<%y_scale = 5%>
<%y_shift = 0%>
-->
<%def star_red(b_index)%>
  <%color1 = 250 + 100*b_index%>
  <%if color1 > 255%>
    <%color1 = 255%>
  <%end%>
  <%return (color1*100).round/100%>
<%end%>

<%def star_green(b_index)%>
  <%color2 = 250 - 80*(b_index.abs)%>
  <%return (color2*100).round/100%>
<%end%>

<%def star_blue(b_index)%>
  <%color3 = 250 - 100*(b_index)%>
  <%if color3 > 255 %>
    <%color3 = 255%>
  <%end%>
  <%return (color3*100).round/100%>
<%end%>

<%def draw_const(const, const_name) %>
  <%i = 0%>
  <%while const[i] != nil%>
    <%x_scale = -5%>
    <%x_shift = 0%>

    <%if const[i][0] > 0%>
      <%x_shift = 900%>
    <%end%>
    <%red = star_red(const[i][3])%>
    <%green = star_green(const[i][3])%>
    <%blue = star_blue(const[i][3])%>
    <circle id="const_name<%=i%>" cx="<%=(const[i][0])*x_scale+x_shift%>" cy="<%=const[i][1]*5%>"
      r="<%=7-const[i][2]%>" opacity="1" style="filter:url(#f1)"
      fill="rgb(<%=red%>,<%=green%>, <%=blue%>)" onclick="<%=const_name%>_Click(<%=i%>)">
      <animateTransform attributeName="transform" type="rotate" dur="6s"from="0
      <%=const[i][0]*x_scale+x_shift%> <%=const[i][1]*5%>" to="360
      <%=const[i][0]*x_scale+x_shift%> <%=const[i][1]*5%>" repeatCount="indefinite"/>
    </circle>
    <%i = i+1%>
  <%end%>
  <%return%>
<%end%>

<%def connect(const, class_name, s1, s2)%>
  <%x_scale = -5%>
  <%x_shift_1 = 0%>
  <%x_shift_2 = 0%>
  <%y_scale = 5%>
  <%y_shift = 0%>

  <%if const[s1][0] > 0%>
    <%x_shift_1 = 900%>
  <%end%>

  <%if const[s2][0] > 0%>
    <%x_shift_2 = 900%>
  <%end%>

  <line class="<%=class_name%>" x1="<%=const[s1][0]*x_scale+x_shift_1%>" y1="<%=const[s1][1]*y_scale+y_shift%>"
    x2="<%=const[s2][0]*x_scale+x_shift_2%>" y2="<%=const[s2][1]*y_scale+y_shift%>"/>
    <%return%>
<%end%>

<%draw_const(@gem, "gem")%>
<%draw_const(@canis_major, "canis_major")%>
<%draw_const(@canis_minor, "canis_minor")%>
<%draw_const(@orion, "orion")%>

</svg>

<script>clickedSkymap()</script>
<script src=timer.js></script>
<script src="map.js"></script>
</div>
